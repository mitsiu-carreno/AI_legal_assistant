#### Herramienta Trivy 

Trivy es una herramienta de escaneo de vulnerabilidades diseñada específicamente para contenedores y sistemas de contenedores, como Docker, Kubernetes y otros entornos similares. Su función principal es identificar y notificar sobre posibles vulnerabilidades en las imágenes de contenedores y sistemas de contenedores. Trivy escanea las imágenes de contenedor en busca de vulnerabilidades conocidas en bibliotecas, binarios y dependencias que se utilizan en esas imágenes.

Algunas de las acciones típicas que realiza Trivy son:

- Escaneo de imágenes: Trivy escanea las imágenes de contenedor en busca de vulnerabilidades conocidas. Esto implica verificar las bibliotecas y binarios utilizados en la imagen en busca de problemas de seguridad.

- Base de datos de vulnerabilidades: Trivy utiliza una base de datos de vulnerabilidades conocidas para comparar las bibliotecas y dependencias en las imágenes de contenedor y determinar si hay vulnerabilidades documentadas para esos componentes.

- Informes de vulnerabilidades: Trivy genera informes detallados sobre las vulnerabilidades encontradas en las imágenes escaneadas, proporcionando información sobre la gravedad de las vulnerabilidades, referencias a soluciones y enlaces a fuentes de información relacionadas.

- Integración en flujos de trabajo DevOps: Trivy se utiliza comúnmente en flujos de trabajo de desarrollo y despliegue de contenedores, como parte de la integración continua (CI) y la entrega continua (CD), para garantizar que las imágenes de contenedor sean seguras antes de implementarlas en producción.

### Vulnerabilidades mas comunes en los contenedores 

- Imágenes no seguras: Usar imágenes de contenedores de fuentes no confiables o no verificar la integridad de las imágenes puede exponer el sistema a malware o vulnerabilidades conocidas.

- Desactualización de software: No mantener actualizadas las imágenes y los componentes del contenedor con parches de seguridad puede dejar el sistema vulnerable a explotaciones conocidas.

- Privilegios excesivos: Dar a un contenedor más privilegios de los necesarios puede aumentar el riesgo de que un atacante pueda comprometer el sistema subyacente.

- Escapar del contenedor (Escape de privilegios): En algunos casos, los atacantes pueden encontrar formas de escapar de un contenedor y acceder al sistema anfitrión, lo que puede tener consecuencias graves.

- Errores en la configuración de red: Configuraciones incorrectas de red pueden permitir que los contenedores accedan a recursos a los que no deberían o expongan servicios de contenedor de manera insegura.

- Escritura insegura de archivos: Permitir que un contenedor escriba archivos en el sistema anfitrión sin restricciones adecuadas puede dar lugar a ataques de escritura arbitraria que pueden dañar el sistema.

- Variables de entorno sensibles: Almacenar credenciales u otra información sensible en variables de entorno dentro de un contenedor puede exponer esa información a riesgos de seguridad si el contenedor es comprometido.

- Falta de aislamiento: La falta de un aislamiento adecuado entre contenedores puede permitir que un contenedor comprometido afecte a otros contenedores en el mismo sistema.

- Auditoría insuficiente: No llevar a cabo un seguimiento adecuado de las actividades dentro de los contenedores puede dificultar la detección de intrusiones y la respuesta a incidentes.

- Falta de actualización de políticas de seguridad: No ajustar las políticas de seguridad para adaptarse a los cambios en las amenazas y en la infraestructura puede dejar a los contenedores desprotegidos.

- Vulnerabilidades de configuración: la configuración incorrecta de un contenedor o la configuración incorrecta en el host pueden provocar más debilidades que deben abordarse. Muchas de estas vulnerabilidades se pueden evitar siguiendo las prácticas recomendadas, como no ejecutar un contenedor como raíz y evitar cualquier escalada de privilegios. Esta es la configuración predeterminada para motores de contenedores como Podman, como se mencionó anteriormente.

- Vulnerabilidades de red: estrechamente relacionadas con las vulnerabilidades de configuración, las vulnerabilidades de red pueden tomar la forma de una configuración incorrecta de un puerto contenedor que resulta en que se exponga en Internet (SSH o Telnet, por ejemplo). Esto podría resultar en un acceso no autorizado a la red de una organización.

- Otro ejemplo es un contenedor mal configurado para que los datos se transmitan a través de HTTPS, lo que significa que un ciberdelincuente puede explotar un sistema utilizando un escáner de red. Esta es una de las estrategias que los ciberdelincuentes pueden utilizar para robar datos de forma remota.

- Vulnerabilidades del sistema operativo de imagen: los contenedores de una red requieren un sistema operativo (SO) de imágenes para funcionar eficazmente (por ejemplo, Linux). Cada sistema operativo tiene sus propias vulnerabilidades que podrían conducir a ataques de denegación de servicio (DOS) y otros exploits similares.

### Contenedor

    podman pull aquasec/trivy

    podman run aquasec/trivy image python:3.4-alpine

Scan IaC misconfiguration

    podman run -v $PWD:/myapp aquasec/trivy config /myapp

Genera SBOM
    
    podman run aquasec/trivy sbom alpine:3.15

- Targets: Container Image, Filesystem, Git Repository (remote), Virtual Machine Image, Kubernetes, AWS
- Scanners: OS packages, software dependencies in use (SBOM), (CVEs), IaC issues and misconfigurations
________________
Source: [GitHub Trivy](https://github.com/aquasecurity/trivy/releases/tag/v0.41.0)
